<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  
  <!-- Primary Meta Tags -->
  <title>Feed restauracÃ­ â€“ GURMAO | ProhlÃ­Å¾ej podle nÃ¡lady</title>
  <meta name="title" content="Feed restauracÃ­ â€“ GURMAO | ProhlÃ­Å¾ej podle nÃ¡lady">
  <meta name="description" content="ProhlÃ­Å¾ej kurÃ¡torovanÃ½ feed nejlepÅ¡Ã­ch restauracÃ­ v ÄŒR. Filtruj podle mÄ›sta, atmosfÃ©ry (LUXE, DRAMA, CHAOS) a typu kuchynÄ›." />
  <meta name="keywords" content="feed restauracÃ­, restaurace podle nÃ¡lady, fine dining Praha, kam jÃ­t najÃ­st, gastro tipy ÄŒR">
  <link rel="canonical" href="https://gurmao.cz/feed.html" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://gurmao.cz/feed.html" />
  <meta property="og:title" content="Feed restauracÃ­ â€“ GURMAO" />
  <meta property="og:description" content="ProhlÃ­Å¾ej kurÃ¡torovanÃ½ feed nejlepÅ¡Ã­ch restauracÃ­. Filtruj podle nÃ¡lady." />
  <meta property="og:image" content="https://gurmao.cz/og-image.jpg" />
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://gurmao.cz/feed.html" />
  <meta name="twitter:title" content="Feed restauracÃ­ â€“ GURMAO" />
  <meta name="twitter:description" content="KurÃ¡torovanÃ½ feed gastro zÃ¡Å¾itkÅ¯ podle tvÃ© nÃ¡lady." />
  <meta name="twitter:image" content="https://gurmao.cz/og-image.jpg" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            gurmaoblack: '#0b0b0d',
            gurmaogold: '#d4af37',
            gurmaored: '#8b1d18',
          },
          boxShadow: {
            glow: '0 0 40px rgba(212,175,55,0.35)'
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  
  <!-- Toast CSS -->
  <link rel="stylesheet" href="toast.css">

  <style>
    body { font-family: 'Inter', sans-serif; }
    h1,h2,h3 { font-family: 'Playfair Display', serif; }
    /* Mobile snap feed */
    .snap-y { scroll-snap-type: y mandatory; }
    .snap-start { scroll-snap-align: start; }
  </style>
</head>
<body class="bg-gurmaoblack text-white overflow-x-hidden">

<script src="toast.js"></script>

<!-- HEADER / NAV + HAMBURGER -->
<header class="sticky top-0 z-50 bg-gurmaoblack/80 backdrop-blur border-b border-white/10">
  <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
    <a href="index.html" class="text-2xl font-bold tracking-tight">GUR<span class="text-gurmaogold">M</span>AO</a>

    <nav class="hidden md:flex gap-6 text-sm items-center">
      <a href="feed.html" class="text-gurmaogold">Feed</a>
      <a href="restaurace.html" class="hover:text-gurmaogold">Restaurace</a>
      <a href="kuchar.html" class="hover:text-gurmaogold">KuchaÅ™i</a>
      <a href="gear.html" class="hover:text-gurmaogold">Gear</a>
      <a href="ai.html" class="hover:text-gurmaogold">AI</a>
      <a href="collections.html" class="hover:text-gurmaogold">SbÃ­rky</a>
      
      <!-- User menu (desktop) -->
      <div id="userMenuDesktop" class="hidden">
        <div class="flex items-center gap-3">
          <span id="userNameDesktop" class="text-white/80"></span>
          <button id="logoutBtnDesktop" class="px-4 py-2 rounded-full border border-white/20 hover:border-gurmaored hover:text-gurmaored text-sm transition">OdhlÃ¡sit</button>
        </div>
      </div>
      <a id="loginLinkDesktop" href="login.html" class="px-4 py-2 rounded-full border border-gurmaogold text-gurmaogold hover:bg-gurmaogold hover:text-black transition">PÅ™ihlÃ¡sit se</a>
    </nav>

    <!-- Mobile hamburger -->
    <button id="menuBtn" class="md:hidden w-11 h-11 rounded-full bg-white/5 border border-white/15 hover:border-gurmaogold hover:text-gurmaogold transition" aria-label="OtevÅ™Ã­t menu">â˜°</button>
  </div>

  <!-- Mobile menu -->
  <div id="menuBackdrop" class="hidden md:hidden fixed inset-0 bg-black/70"></div>
  <div id="mobileMenu" class="hidden md:hidden fixed inset-x-0 top-[65px]">
    <div class="mx-4 rounded-3xl border border-white/10 bg-gurmaoblack/95 backdrop-blur p-4">
      <div class="flex items-center justify-between px-2 pb-3">
        <div class="text-sm text-white/60">Navigace</div>
        <button id="menuClose" class="w-10 h-10 rounded-full bg-white/5 border border-white/15 hover:border-gurmaogold hover:text-gurmaogold transition" aria-label="ZavÅ™Ã­t menu">âœ•</button>
      </div>
      <nav class="grid gap-2">
        <a href="index.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">DomÅ¯</a>
        <a href="feed.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">Feed</a>
        <a href="restaurace.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">Restaurace</a>
        <a href="kuchar.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">KuchaÅ™i</a>
        <a href="gear.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">Gear</a>
        <a href="ai.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">AI</a>
        <a href="collections.html" class="px-4 py-3 rounded-2xl bg-white/5 hover:bg-white/10">SbÃ­rky</a>
        
        <!-- User menu (mobile) -->
        <div id="userMenuMobile" class="hidden">
          <div class="px-4 py-3 rounded-2xl bg-white/5 text-center">
            <div id="userNameMobile" class="text-white/80 mb-2"></div>
            <button id="logoutBtnMobile" class="w-full px-4 py-2 rounded-full border border-gurmaored text-gurmaored hover:bg-gurmaored hover:text-white transition">OdhlÃ¡sit se</button>
          </div>
        </div>
        <a id="loginLinkMobile" href="login.html" class="px-4 py-3 rounded-2xl border border-white/20 hover:border-gurmaogold hover:text-gurmaogold">PÅ™ihlÃ¡sit se</a>
      </nav>
    </div>
  </div>
</header>

<!-- MOBILE SNAP FEED -->
<main class="md:hidden">
  <div id="feed" class="snap-y h-[calc(100vh-65px)] overflow-y-auto"></div>

  <!-- Floating actions -->
  <div class="fixed right-4 bottom-6 flex flex-col gap-3">
    <button id="btnSave" class="w-12 h-12 rounded-full bg-white/10 border border-white/15 hover:border-gurmaogold hover:text-gurmaogold transition" title="UloÅ¾it">ğŸ¤</button>
    <button id="btnFire" class="w-12 h-12 rounded-full bg-white/10 border border-white/15 hover:border-gurmaogold hover:text-gurmaogold transition" title="WOW">ğŸ”¥</button>
    <button id="btnDrool" class="w-12 h-12 rounded-full bg-white/10 border border-white/15 hover:border-gurmaogold hover:text-gurmaogold transition" title="ChuÅ¥">ğŸ¤¤</button>
  </div>
</main>

<!-- DESKTOP GRID -->
<main class="hidden md:block">
  <div class="max-w-6xl mx-auto px-6 py-10">
    <div class="flex items-end justify-between gap-6">
      <div>
        <h1 class="text-4xl">Feed</h1>
        <p class="text-white/60 mt-2">KurÃ¡torovanÃ½ svÄ›t. Minimum slov. Maximum chuti.</p>
      </div>
      <div class="flex gap-3">
        <a href="ai.html" class="px-5 py-3 rounded-full bg-white/5 hover:bg-gurmaogold hover:text-black transition">Kam dnes podle nÃ¡lady</a>
        <a href="collections.html" class="px-5 py-3 rounded-full border border-white/20 hover:border-gurmaogold hover:text-gurmaogold transition">SbÃ­rky</a>
      </div>
    </div>

    <!-- Search & Filters -->
    <div class="mt-8 flex flex-col sm:flex-row gap-3">
      <div class="flex-1 relative">
        <input 
          type="text" 
          id="searchInput" 
          placeholder="ğŸ” Hledej restauraci..."
          class="w-full px-5 py-3 rounded-full bg-white/5 border border-white/10 focus:border-gurmaogold focus:outline-none text-white placeholder:text-white/40"
        />
      </div>
      
      <select id="cityFilter" class="px-5 py-3 rounded-full bg-white/5 border border-white/10 focus:border-gurmaogold focus:outline-none text-white">
        <option value="">VÅ¡echna mÄ›sta</option>
        <option value="Praha">Praha</option>
        <option value="Brno">Brno</option>
        <option value="Ostrava">Ostrava</option>
      </select>
      
      <select id="vibeFilter" class="px-5 py-3 rounded-full bg-white/5 border border-white/10 focus:border-gurmaogold focus:outline-none text-white">
        <option value="">VÅ¡echny vibes</option>
        <option value="LUXE">ğŸ· LUXE</option>
        <option value="DRAMA">ğŸ”¥ DRAMA</option>
        <option value="CHAOS">ğŸŒ® CHAOS</option>
        <option value="DARK">ğŸ–¤ DARK</option>
        <option value="PURE">ğŸŒ¿ PURE</option>
        <option value="CALM">ğŸŒŠ CALM</option>
      </select>
      
      <button id="clearFilters" class="px-5 py-3 rounded-full border border-white/20 hover:border-gurmaored hover:text-gurmaored transition whitespace-nowrap">
        âœ• Reset
      </button>
    </div>

    <div id="resultsCount" class="mt-4 text-sm text-white/40"></div>
    <div id="grid" class="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-8"></div>
    <div id="noResults" class="hidden mt-10 text-center text-white/40">
      <div class="text-4xl mb-3">ğŸ¤·</div>
      <p>Nic jsme nenaÅ¡li. Zkus jinÃ½ filtr.</p>
    </div>
  </div>
</main>

<script>
  // MVP data
  const items = [
    {
      id:'noir-table',
      vibe:'ğŸ· LUXE',
      name:'Noir Table',
      city:'Praha',
      tag:'fine dining',
      href:'restaurace-noir-table.html',
      img:'https://images.unsplash.com/photo-1541544741938-0af808871cc0?auto=format&fit=crop&w=1200&q=80'
    },
    {
      id:'ember-steak',
      vibe:'ğŸ”¥ DRAMA',
      name:'Ember Steak',
      city:'Brno',
      tag:'steakhouse',
      href:'restaurace-noir-table.html',
      img:'https://images.unsplash.com/photo-1600891964599-f61ba0e24092?auto=format&fit=crop&w=1200&q=80'
    },
    {
      id:'la-calle',
      vibe:'ğŸŒ® CHAOS',
      name:'La Calle',
      city:'Ostrava',
      tag:'street food',
      href:'restaurace-noir-table.html',
      img:'https://images.unsplash.com/photo-1529692236671-f1dc2c0f2c0e?auto=format&fit=crop&w=1200&q=80'
    },
  ];

  // Saved system
  const lsKey = 'gurmao_saved';
  const getSaved = () => new Set(JSON.parse(localStorage.getItem(lsKey) || '[]'));
  const setSaved = (set) => localStorage.setItem(lsKey, JSON.stringify([...set]));

  // Mobile feed render
  const feed = document.getElementById('feed');
  if (feed) {
    feed.innerHTML = items.map(x=>`
      <article class="snap-start h-[calc(100vh-65px)] relative">
        <a href="${x.href}" class="absolute inset-0">
          <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,rgba(212,175,55,0.12),transparent_70%)]"></div>
          <div class="absolute inset-0 bg-cover bg-center" style="background-image:url('${x.img}')"></div>
          <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-black/20"></div>
          <div class="absolute left-6 right-20 bottom-10">
            <div class="text-gurmaogold text-sm">${x.vibe}</div>
            <div class="text-3xl font-semibold mt-1">${x.name}</div>
            <div class="text-white/70 mt-1">${x.city} Â· ${x.tag}</div>
          </div>
        </a>
      </article>
    `).join('');

    const currentIndex = () => Math.round(feed.scrollTop / feed.clientHeight);
    const act = async (type) => {
      const idx = Math.max(0, Math.min(items.length-1, currentIndex()));
      const cur = items[idx];
      if (!cur) return;

      if (type === 'save') {
        const btn = document.getElementById('btnSave');
        const originalText = btn.textContent;
        
        try {
          // Show loading
          btn.classList.add('btn-loading');
          btn.textContent = 'â³';
          
          // Simulate async save (replace with real Supabase call)
          await new Promise(resolve => setTimeout(resolve, 500));
          
          const s = getSaved();
          const isAdding = !s.has(cur.id);
          
          if (isAdding) {
            s.add(cur.id);
            btn.textContent = 'ğŸ–¤';
            toastSuccess(`âœ… ${cur.name} uloÅ¾eno!`);
          } else {
            s.delete(cur.id);
            btn.textContent = 'ğŸ¤';
            toastInfo(`${cur.name} odebrÃ¡no`);
          }
          
          setSaved(s);
        } catch (error) {
          btn.textContent = originalText;
          toastError('âŒ NepodaÅ™ilo se uloÅ¾it');
        } finally {
          btn.classList.remove('btn-loading');
        }
      } else {
        toastInfo(type === 'fire' ? 'ğŸ”¥ ZapsÃ¡no: WOW' : 'ğŸ¤¤ ZapsÃ¡no: chuÅ¥');
      }
    };

    // init save icon based on first card
    const init = () => {
      const s = getSaved();
      const cur = items[0];
      if(cur) document.getElementById('btnSave').textContent = s.has(cur.id) ? 'â¤ï¸' : 'ğŸ¤';
    };
    init();

    document.getElementById('btnSave')?.addEventListener('click',()=>act('save'));
    document.getElementById('btnFire')?.addEventListener('click',()=>act('fire'));
    document.getElementById('btnDrool')?.addEventListener('click',()=>act('drool'));

    // update save icon on scroll
    feed.addEventListener('scroll', () => {
      const idx = Math.max(0, Math.min(items.length-1, currentIndex()));
      const s = getSaved();
      document.getElementById('btnSave').textContent = s.has(items[idx].id) ? 'â¤ï¸' : 'ğŸ¤';
    }, { passive: true });
  }

  // Desktop grid render
  const grid = document.getElementById('grid');
  const noResults = document.getElementById('noResults');
  const resultsCount = document.getElementById('resultsCount');
  
  let filteredItems = [...items];

  function renderGrid() {
    if (!grid) return;
    
    const saved = getSaved();
    
    if (filteredItems.length === 0) {
      grid.classList.add('hidden');
      noResults?.classList.remove('hidden');
      if (resultsCount) resultsCount.textContent = '';
      return;
    }
    
    grid.classList.remove('hidden');
    noResults?.classList.add('hidden');
    if (resultsCount) resultsCount.textContent = `Zobrazeno ${filteredItems.length} restauracÃ­`;
    
    grid.innerHTML = filteredItems.map(x=>`
      <div class="rounded-3xl overflow-hidden bg-white/5 hover:bg-white/10 transition">
        <a href="${x.href}" class="block">
          <div class="aspect-[3/4] bg-cover bg-center" style="background-image:url('${x.img}')"></div>
        </a>
        <div class="p-5 flex items-start justify-between gap-4">
          <div>
            <div class="text-sm text-gurmaogold mb-1">${x.vibe}</div>
            <div class="text-xl font-semibold">${x.name}</div>
            <div class="text-white/60 text-sm mt-1">${x.city} Â· ${x.tag}</div>
          </div>
          <button data-save="${x.id}" class="w-11 h-11 rounded-full bg-white/5 border border-white/15 hover:border-gurmaogold hover:text-gurmaogold transition" title="UloÅ¾it">
            ${saved.has(x.id) ? 'â¤ï¸' : 'ğŸ¤'}
          </button>
        </div>
      </div>
    `).join('');

    grid.querySelectorAll('[data-save]').forEach(btn=>{
      btn.addEventListener('click', async (e)=>{
        e.preventDefault();
        const id = btn.getAttribute('data-save');
        const originalText = btn.textContent;
        const restaurant = items.find(x => x.id === id);
        
        try {
          // Show loading
          btn.classList.add('btn-loading');
          btn.textContent = 'â³';
          
          // Simulate async save (replace with real Supabase call)
          await new Promise(resolve => setTimeout(resolve, 500));
          
          const s = getSaved();
          const isAdding = !s.has(id);
          
          if (isAdding) {
            s.add(id);
            btn.textContent = 'ğŸ–¤';
            toastSuccess(`âœ… ${restaurant?.name || 'Restaurace'} uloÅ¾eno!`);
          } else {
            s.delete(id);
            btn.textContent = 'ğŸ¤';
            toastInfo(`${restaurant?.name || 'Restaurace'} odebrÃ¡no`);
          }
          
          setSaved(s);
        } catch (error) {
          btn.textContent = originalText;
          toastError('âŒ NepodaÅ™ilo se uloÅ¾it');
        } finally {
          btn.classList.remove('btn-loading');
        }
      });
    });
  }

  // Filter function
  function applyFilters() {
    const searchTerm = document.getElementById('searchInput')?.value.toLowerCase() || '';
    const cityFilter = document.getElementById('cityFilter')?.value || '';
    const vibeFilter = document.getElementById('vibeFilter')?.value || '';
    
    filteredItems = items.filter(item => {
      const matchesSearch = !searchTerm || 
        item.name.toLowerCase().includes(searchTerm) ||
        item.tag.toLowerCase().includes(searchTerm) ||
        item.city.toLowerCase().includes(searchTerm);
      
      const matchesCity = !cityFilter || item.city === cityFilter;
      const matchesVibe = !vibeFilter || item.vibe.includes(vibeFilter);
      
      return matchesSearch && matchesCity && matchesVibe;
    });
    
    renderGrid();
  }

  // Event listeners for filters
  document.getElementById('searchInput')?.addEventListener('input', applyFilters);
  document.getElementById('cityFilter')?.addEventListener('change', applyFilters);
  document.getElementById('vibeFilter')?.addEventListener('change', applyFilters);
  
  document.getElementById('clearFilters')?.addEventListener('click', () => {
    if (document.getElementById('searchInput')) document.getElementById('searchInput').value = '';
    if (document.getElementById('cityFilter')) document.getElementById('cityFilter').value = '';
    if (document.getElementById('vibeFilter')) document.getElementById('vibeFilter').value = '';
    applyFilters();
  });

  // Initial render
  if (grid) {
    renderGrid();
  }
</script>

<footer class="py-10 border-t border-white/10 text-center text-sm text-white/40">
  Â© 2025 GURMAO.cz Â· Nejez. ProÅ¾ij.
</footer>

<script src="app.js"></script>

<!-- User authentication UI -->
<script>
  // Check if user is logged in
  const user = JSON.parse(localStorage.getItem('gurmao_user') || 'null');
  
  if (user && user.loggedIn) {
    // Show user menu
    document.getElementById('userMenuDesktop').classList.remove('hidden');
    document.getElementById('userMenuMobile').classList.remove('hidden');
    document.getElementById('loginLinkDesktop').classList.add('hidden');
    document.getElementById('loginLinkMobile').classList.add('hidden');
    
    // Display user name
    const userName = user.name || user.email.split('@')[0];
    document.getElementById('userNameDesktop').textContent = userName;
    document.getElementById('userNameMobile').textContent = `PÅ™ihlÃ¡Å¡en: ${userName}`;
    
    // Logout handlers
    [document.getElementById('logoutBtnDesktop'), document.getElementById('logoutBtnMobile')].forEach(btn => {
      btn.addEventListener('click', () => {
        localStorage.removeItem('gurmao_user');
        window.location.href = 'index.html';
      });
    });
  }
</script>

</body>
</html>
